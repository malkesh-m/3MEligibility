<div class="table-wrapper">
    <table mat-table [dataSource]="dataSource" matSort>
        <!-- Exception Name -->
        <ng-container matColumnDef="ExceptionName">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'Exception Name' | translate }}</th>
            <td mat-cell *matCellDef="let entity" class="fw-medium">{{ entity.ExceptionName }}</td>
        </ng-container>

        <!-- Description -->
        <ng-container matColumnDef="Description">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'Description' | translate }}</th>
            <td mat-cell *matCellDef="let entity">{{ entity.Description || '-' }}</td>
        </ng-container>

        <!-- Temporary Exception -->
        <ng-container matColumnDef="TemporaryException">
            <th mat-header-cell *matHeaderCellDef>
                <span>{{ 'Temporary' | translate }}</span>
                <mat-icon class="info-icon" (click)="toggleColumn('exceptionStartDate', 'exceptionEndDate')"
                    matTooltip="{{ 'Show/Hide Dates' | translate }}">
                    {{ displayedColumns.includes('exceptionStartDate') ? 'unfold_less' : 'unfold_more' }}
                </mat-icon>
            </th>
            <td mat-cell *matCellDef="let entity">
                <span class="status-badge" [class.active]="entity.TemporaryException === 'Yes'"
                    [class.inactive]="entity.TemporaryException === 'No'">
                    {{ entity.TemporaryException }}
                </span>
            </td>
        </ng-container>

        <!-- Dates -->
        <ng-container matColumnDef="exceptionStartDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'Start Date' | translate }}</th>
            <td mat-cell *matCellDef="let entity" class="mono text-xs">{{ entity.exceptionStartDate | date: 'mediumDate'
                }}</td>
        </ng-container>

        <ng-container matColumnDef="exceptionEndDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'End Date' | translate }}</th>
            <td mat-cell *matCellDef="let entity" class="mono text-xs">{{ entity.exceptionEndDate | date: 'mediumDate'
                }}</td>
        </ng-container>

        <!-- Scope -->
        <ng-container matColumnDef="Scope">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'Scope' | translate }}</th>
            <td mat-cell *matCellDef="let entity">
                <span class="text-indigo text-xs fw-medium">{{ entity.Scope }}</span>
            </td>
        </ng-container>

        <!-- Status -->
        <ng-container matColumnDef="Status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'Status' | translate }}</th>
            <td mat-cell *matCellDef="let entity">
                <span class="status-badge" [class.active]="entity.Status === 'Active'"
                    [class.inactive]="entity.Status === 'Inactive'">
                    {{ entity.Status }}
                </span>
            </td>
        </ng-container>

        <!-- Rule Expression -->
        <ng-container matColumnDef="ExpShown">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'Exception Rule' | translate }}</th>
            <td mat-cell *matCellDef="let entity" class="mono text-xs">{{ entity.expShown || 'N/A' }}</td>
        </ng-container>

        <!-- Percentages -->
        <ng-container matColumnDef="FixedPercentage">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'Fixed %' | translate }}</th>
            <td mat-cell *matCellDef="let entity" class="mono">{{ entity.FixedPercentage }}</td>
        </ng-container>

        <ng-container matColumnDef="VariationPercentage">
            <th mat-header-cell *matHeaderCellDef mat-sort-header>{{ 'Var %' | translate }}</th>
            <td mat-cell *matCellDef="let entity" class="mono">{{ entity.VariationPercentage }}</td>
        </ng-container>

        <!-- Actions -->
        <ng-container matColumnDef="Actions">
            <th mat-header-cell *matHeaderCellDef class="text-left">{{ 'Actions' | translate }}</th>
            <td mat-cell *matCellDef="let entity">
                <div class="cell-actions">
                    <mat-icon appUseractivity="User Click on Edit button" [componentName]="'ExceptionComponent'"
                        [actionType]="'ButtonClick'" class="clickable-icon edit" (click)="editRecord(entity)"
                        matTooltip="{{ 'Edit' | translate }}">edit_note</mat-icon>

                    <mat-icon appUseractivity="User Click on Delete button" [componentName]="'ExceptionComponent'"
                        [actionType]="'ButtonClick'" class="clickable-icon delete" (click)="deleteRecord(entity)"
                        matTooltip="{{ 'Delete' | translate }}">delete_outline</mat-icon>
                </div>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
    </table>

    <mat-paginator class="paginator" [pageSizeOptions]="[10, 25, 50]" showFirstLastButtons></mat-paginator>
</div>